---

- name: Only playbook for my project
  hosts: localhost
  become: true
  tasks:

    - name: Add cassandra repository
      apt_repository:
        repo: deb http://www.apache.org/dist/cassandra/debian 311x main
        state: present

    - name: Add apt key for cassandra
      apt_key:
        url: https://www.apache.org/dist/cassandra/KEYS
        state: present

    - name: Add the other apt key for cassandra
      apt_key:
        keyserver: pool.sks-keyservers.net
        id: A278B781FE4B2BDA


    - name: Update cache
      apt:
        update_cache: yes


    - name: Install needed libraries
      apt:
        name: "{{ item }}"
        state: present
      with_items:
        - default-jdk
        - cassandra

  handlers:
    - name: start cassandra
      systemd:
        name: cassandra.service
        state: started




- name: Check that cluster is running
  hosts: localhost
  tasks:

    - name: Describe Cassandra cluster
      command: /usr/bin/nodetool describecluster

        




